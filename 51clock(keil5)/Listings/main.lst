C51 COMPILER V9.57.0.0   MAIN                                                              01/12/2026 15:52:53 PAGE 1   


C51 COMPILER V9.57.0.0, COMPILATION OF MODULE MAIN
OBJECT MODULE PLACED IN .\Objects\main.obj
COMPILER INVOKED BY: D:\Keil_v5\C51\BIN\C51.EXE main.c OPTIMIZE(8,SPEED) BROWSE DEBUG OBJECTEXTEND PRINT(.\Listings\main
                    -.lst) TABS(2) OBJECT(.\Objects\main.obj)

line level    source

   1          #include <STC89C5xRC.H>
   2          #include <intrins.h>
   3          #define uchar unsigned char
   4          #define uint unsigned int
   5          #define DS18B20_SKIP_ROM 0xCC
   6          #define DS18B20_CONVERT_T 0x44
   7          #define DS18B20_READ_SCRATCHPAD 0xBE 
   8          
   9          sbit onewire_dq = P3^7;//æ¸©åº¦ä¼ æ„Ÿå™¨å¼•è„š
  10          float T;//æ¸©åº¦åˆå§‹æ•°æ®
  11          
  12          //æ•°ç ç®¡æ®µé€‰
  13          uchar table[] = {0xC0,0xF9,0xA4,0xB0,0x99,0x92,0x82,0xF8,0x80,0x90,0xBF};//0~9,-
  14          uchar table_dot[] = {0x40,0x79,0x24,0x30,0x19,0x12,0x02,0x78,0x00,0x10,0xBF};//å¸¦å°æ•°ç‚¹0~9,-
  15          
  16          sbit BEEP=P1^5;//èœ‚é¸£å™¨
  17          
  18          uchar whereNow; //0:æ—¶é’Ÿç•Œé¢ï¼›1:è°ƒæ—¶ç•Œé¢ï¼›2:é—¹é’Ÿç•Œé¢ï¼›3:æ—¥å†ç•Œé¢ï¼›4:ç§’è¡¨ç•Œé¢ï¼›5:æ
             -¸©åº¦ç•Œé¢
  19          
  20          sbit K1=P1^0;//äº”ä¸ªç‹¬ç«‹æŒ‰é”®
  21          sbit K2=P1^1;
  22          sbit K3=P1^2;
  23          sbit K4=P1^3;
  24          sbit K5=P1^4;
  25           
  26          #define shanCount 128//é€‰ä¸­ä½ç½®é—ªçƒè®¡æ•°æ ‡å¿—
  27          uchar blankCount;//ç©ºç™½æ˜¾ç¤º è®¡æ•°æ ‡å¿—
  28          uchar normalCount;//æ­£å¸¸æ˜¾ç¤º è®¡æ•°æ ‡å¿—
  29          
  30          uchar shi=0,fen=0,miao=0; //æ—¶é’Ÿæ—¶ã€åˆ†ã€ç§’ åˆå§‹æ•°æ®
  31          
  32          uchar clockSetLocation;//è®°å½•è°ƒæ—¶é€‰ä¸­çš„ä½ç½® 0,ä¸é—ªçƒ,ä¸”æ— æ³•ä½¿ç”¨åŠ å‡æŒ‰é’®
  33          
  34          uchar alarmSetLocation;//è®°å½•é—¹é’Ÿè®¾ç½®æ—¶çš„æ‰€é€‰ä½ç½®
  35          uchar shi1=0,fen1=0,miao1=5;//é—¹é’Ÿæ—¶ã€åˆ†ã€ç§’ åˆå§‹æ•°æ® 
  36          bit alarmOnOff;//è¡¨æ˜é—¹é’Ÿæ˜¯å¦å¼€å¯
  37          bit alarmSetOrNot;//è¡¨æ˜æ˜¯å¦æ­£åœ¨è®¾ç½®é—¹é’Ÿ
  38          uchar cldSetLocation;//è®°å½•é—¹é’Ÿè®¾ç½®æ—¶çš„æ‰€é€‰ä½ç½®
  39          
  40          uint year=2025; //æ—¥å† å¹´ åˆå§‹æ•°æ®
  41          uchar month=12,day=28;//æ—¥å† æœˆã€æ—¥ åˆå§‹æ•°æ®
  42          #define minYear 2020//è®¾å®šæ—¥å†å¯æ˜¾ç¤ºçš„å¹´ä»½ä¸Šä¸‹é™
  43          #define maxYear 2050
  44          bit isLeapYear; //è¡¨æ˜æ˜¯å¦æ˜¯é—°å¹´ 1ï¼Œæ˜¯ï¼›0ï¼Œå¦ã€‚
  45          bit cldSetOrNot;//è¡¨æ˜æ˜¯å¦æ­£åœ¨è®¾ç½®æ—¥å†
  46          uchar commonYearTable[]={0,31,28,31,30,31,30,31,31,30,31,30,31};//è®°å½•å¹³å¹´æ¯ä¸ªæœˆæœ‰å¤šå°‘å¤©
  47          uchar leapYearTable[]={0,31,29,31,30,31,30,31,31,30,31,30,31};  //è®°å½•é—°å¹´æ¯ä¸ªæœˆæœ‰å¤šå°‘å¤©
  48          
  49          uint stopwatch_time_fen = 0,stopwatch_time_miao = 0,stopwatch_time_miao_2 = 0;//ç§’è¡¨ç´¯è®¡æ—¶é—´ï¼ˆæ¯«ç§
             -’ï¼‰
  50          uchar stopwatch_state = 0;  //0-åœæ­¢ï¼Œ1-è¿è¡Œï¼Œ2-æš‚åœ
  51          uint watch_count = 0;
  52          
C51 COMPILER V9.57.0.0   MAIN                                                              01/12/2026 15:52:53 PAGE 2   

  53          void delay1ms(unsigned int xms) //@12.000MHz
  54          {
  55   1        unsigned char data i, j;
  56   1        while(xms--)
  57   1        {
  58   2          i = 2;
  59   2          j = 239;
  60   2          do
  61   2          {
  62   3            while (--j);
  63   3          } while (--i);
  64   2        }
  65   1      }
  66          
  67          unsigned char onewire_Init()
  68          {
  69   1        unsigned char i;
  70   1        unsigned char AckBit;
  71   1        onewire_dq = 1;
  72   1        onewire_dq = 0;
  73   1        i = 247;
  74   1        while (--i);//delay 500us
  75   1        onewire_dq = 1;
  76   1        i = 32;
  77   1        while (--i);//delay 70us
  78   1        AckBit = onewire_dq;
  79   1        i = 247;
  80   1        while (--i);//delay 500us
  81   1        return AckBit;
  82   1      }
  83          
  84          void onewire_sendbit(uchar Bit)
  85          {
  86   1        unsigned char i;
  87   1        onewire_dq = 0;
  88   1        i = 4;
  89   1        while (--i);//delay 10us
  90   1        onewire_dq = Bit;
  91   1        i = 24;
  92   1        while (--i);//delay 50us
  93   1        onewire_dq = 1;
  94   1      }
  95          
  96          unsigned char onewire_receivebit()
  97          {
  98   1        unsigned char i;
  99   1        unsigned char Bit;
 100   1        onewire_dq = 0;
 101   1        i = 2;
 102   1        while (--i);//delay 5us
 103   1        onewire_dq = 1;
 104   1        i = 2;
 105   1        while (--i);//delay 5us
 106   1        Bit = onewire_dq;
 107   1        i = 24;
 108   1        while (--i);//delay 50us
 109   1        return Bit;
 110   1      }
 111          
 112          void onewire_sendbyte(uchar Byte)
 113          {
 114   1        unsigned char i;
C51 COMPILER V9.57.0.0   MAIN                                                              01/12/2026 15:52:53 PAGE 3   

 115   1        for(i = 0;i < 8;i++)
 116   1        {
 117   2          onewire_sendbit(Byte & (0x01 << i));
 118   2        }
 119   1      }
 120          
 121          unsigned char onewire_receivebyte()
 122          {
 123   1        unsigned char i;
 124   1        unsigned char Byte = 0x00;
 125   1        for(i = 0;i < 8;i++)
 126   1        {
 127   2          if(onewire_receivebit())
 128   2          {
 129   3            Byte |= (0x01 << i);
 130   3          }
 131   2        }
 132   1        return Byte;
 133   1      }
 134          
 135          void DS18B20_ConvertT()
 136          {
 137   1        onewire_Init();
 138   1        onewire_sendbyte(DS18B20_SKIP_ROM);
 139   1        onewire_sendbyte(DS18B20_CONVERT_T);
 140   1      }
 141          
 142          float DS18B20_ReadT()
 143          {
 144   1        uchar TLSB,TMSB;
 145   1        int Temp;
 146   1        float T;
 147   1        onewire_Init();
 148   1        onewire_sendbyte(DS18B20_SKIP_ROM);
 149   1        onewire_sendbyte(DS18B20_READ_SCRATCHPAD);
 150   1        TLSB = onewire_receivebyte();
 151   1        TMSB = onewire_receivebyte();
 152   1        Temp = (TMSB << 8) | TLSB;
 153   1        T = Temp *0.0625;
 154   1        return T;
 155   1      }
 156          
 157          void Timer0_Init(void)    //1æ¯«ç§’@12.000MHz
 158          {
 159   1        AUXR &= 0x7F;     //å®šæ—¶å™¨æ—¶é’Ÿ12Tæ¨¡å¼
 160   1        TMOD &= 0xF0;     //è®¾ç½®å®šæ—¶å™¨æ¨¡å¼
 161   1        TMOD |= 0x01;     //è®¾ç½®å®šæ—¶å™¨æ¨¡å¼
 162   1        TL0 = 0x18;       //è®¾ç½®å®šæ—¶åˆå§‹å€¼
 163   1        TH0 = 0xFC;       //è®¾ç½®å®šæ—¶åˆå§‹å€¼
 164   1        TF0 = 0;        //æ¸…é™¤TF0æ ‡å¿—
 165   1        TR0 = 1;        //å®šæ—¶å™¨0å¼€å§‹è®¡æ—¶
 166   1        ET0 = 1;        //ä½¿èƒ½å®šæ—¶å™¨0ä¸­æ–­
 167   1        EA = 1;
 168   1      }
 169          
 170          void Timer0_Isr(void) interrupt 1
 171          {
 172   1        static uint count=0;
 173   1        TL0 = 0x18;       //è®¾ç½®å®šæ—¶åˆå§‹å€¼
 174   1        TH0 = 0xFC;       //è®¾ç½®å®šæ—¶åˆå§‹å€¼
 175   1        count++;//å®šæ—¶å™¨è®¡æ•°æ ‡å¿—+1
 176   1        
C51 COMPILER V9.57.0.0   MAIN                                                              01/12/2026 15:52:53 PAGE 4   

 177   1        if(whereNow == 4 && stopwatch_state == 1) // åœ¨ç§’è¡¨ç•Œé¢ä¸”æ­£åœ¨è¿è¡Œ
 178   1        {
 179   2          watch_count++;
 180   2          
 181   2          if(10 == watch_count)
 182   2          {
 183   3            stopwatch_time_miao_2++;// å¢åŠ 10æ¯«ç§’ï¼ˆ0.01ç§’ï¼‰
 184   3            watch_count=0;
 185   3          }
 186   2          if(100 ==stopwatch_time_miao_2)
 187   2          {
 188   3            stopwatch_time_miao++;
 189   3            stopwatch_time_miao_2=0;
 190   3          }
 191   2          if(60 == stopwatch_time_miao)
 192   2          {
 193   3            stopwatch_time_fen++;
 194   3            stopwatch_time_miao=0;
 195   3          }
 196   2          if(60 == stopwatch_time_fen)
 197   2          {
 198   3            stopwatch_time_fen=0;
 199   3          }
 200   2        }
 201   1        
 202   1        if(1000==count)//å®šæ—¶å™¨æ¬¡æ•°è¾¾åˆ°1000æ¬¡ï¼Œç§’+1
 203   1        {
 204   2          miao++;
 205   2          T = DS18B20_ReadT();
 206   2          count=0;//å®šæ—¶å™¨æ¬¡æ•°æ¸…é›¶
 207   2        }
 208   1        if(60==miao)//ç§’è®¡æ•°è¾¾åˆ°60æ¬¡ï¼Œåˆ†+1
 209   1        {
 210   2          fen++;
 211   2          miao=0;//ç§’è®¡æ•°æ¸…é›¶
 212   2        }
 213   1        if(60==fen)//åˆ†è®¡æ•°è¾¾åˆ°60æ¬¡ï¼Œæ—¶+1
 214   1        {
 215   2          shi++;
 216   2          fen=0;//åˆ†è®¡æ•°æ¸…é›¶
 217   2        }
 218   1        if(24==shi)//æ—¶è®¡æ•°è¾¾åˆ°24æ¬¡ï¼Œæ—¥+1
 219   1        {   
 220   2          day++;
 221   2          shi=0;//æ—¶è®¡æ•°æ¸…é›¶
 222   2        } 
 223   1        if(0==isLeapYear)//å¦‚æœæ˜¯å¹³å¹´  
 224   1        { 
 225   2          if(day>commonYearTable[month])
 226   2          {
 227   3             day=1;//å¦‚æœæ—¥è®¡æ•°è¶…è¿‡æœ¬æœˆå¤©æ•°ï¼Œåˆ™å˜ä¸º1
 228   3             month++;
 229   3          }
 230   2        }
 231   1        else      //å¦‚æœæ˜¯é—°å¹´
 232   1        {
 233   2          if(day>leapYearTable[month])
 234   2          {
 235   3             day=1;//å¦‚æœæ—¥è®¡æ•°è¶…è¿‡æœ¬æœˆå¤©æ•°ï¼Œåˆ™å˜ä¸º1
 236   3             month++;
 237   3          }
 238   2        }   
C51 COMPILER V9.57.0.0   MAIN                                                              01/12/2026 15:52:53 PAGE 5   

 239   1        if(month>12)
 240   1        {
 241   2          month=1;//å¦‚æœæœˆè®¡æ•°è¶…è¿‡12ï¼Œåˆ™å˜ä¸º1
 242   2          year++;
 243   2        }
 244   1        if(year>maxYear)
 245   1        {
 246   2          year=minYear;//å¦‚æœå¹´è®¡æ•°è¶…è¿‡ä¸€å®šé™åº¦ï¼Œåˆ™å˜ä¸ºæœ€ä½é™åº¦å¹´ä»½
 247   2        }
 248   1      }
 249          
 250          void is_leap_year()//--------------------------åˆ¤æ–­æ˜¯å¦æ˜¯é—°å¹´
 251          {
 252   1        if((year%4==0 && year%100!=0) || (year%400==0))
 253   1        isLeapYear=1;
 254   1        else
 255   1        isLeapYear=0;
 256   1      }
 257          
 258          void smg(uchar Location,Number)//æ•°ç ç®¡å•ä¸ªä½ç½®äº®ä¸€ä¸‹
 259          {
 260   1        switch(Location)
 261   1        {
 262   2          case 1:P0 = 0xFE;break;
 263   2          case 2:P0 = 0xFD;break;
 264   2          case 3:P0 = 0xFB;break;
 265   2          case 4:P0 = 0xF7;break;
 266   2          case 5:P0 = 0xEF;break;
 267   2          case 6:P0 = 0xDF;break;
 268   2          case 7:P0 = 0xBF;break;
 269   2          case 8:P0 = 0x7F;break;
 270   2        }
 271   1        P2 = Number; 
 272   1        delay1ms(1);
 273   1        P2 = 0xFF;
 274   1      }
 275          
 276          void clock_display()//-------------------------æ•°ç ç®¡åŠ¨æ€æ˜¾ç¤ºæ—¶é’Ÿç•Œé¢
 277          {
 278   1        //æ—¶çš„åä½ 
 279   1          //å¦‚æœæ­£åœ¨è°ƒæ•´æ­¤ä½ç½®ä¸”é—ªçƒç©ºç™½è®¡æ•°ä¸ä¸º0ï¼Œåˆ™æ­¤ä½ç½®ç»§ç»­ç©ºç™½æ˜¾ç¤º
 280   1          if(1 == clockSetLocation && blankCount>0)
 281   1          {
 282   2            smg(1,0xFF);
 283   2            blankCount--;
 284   2          }
 285   1          //å¦‚æœæ­£åœ¨è°ƒæ•´æ­¤ä½ç½®ä¸”é—ªçƒæ­£å¸¸è®¡æ•°ä¸ä¸º0ï¼Œåˆ™æ­¤ä½ç½®ç»§ç»­æ­£å¸¸æ˜¾ç¤º
 286   1          else if(1 == clockSetLocation && normalCount>0)
 287   1          {
 288   2            smg(1,table[shi/10]);
 289   2            normalCount--;
 290   2          }
 291   1          else if(1 == clockSetLocation)
 292   1          {
 293   2            blankCount = shanCount;//é—ªçƒæ ‡å¿—åˆå§‹åŒ–
 294   2            normalCount = shanCount;  
 295   2          }
 296   1          else
 297   1          smg(1,table[shi/10]);
 298   1      
 299   1        //æ—¶çš„ä¸ªä½ 
 300   1          //å¦‚æœæ­£åœ¨è°ƒæ•´æ­¤ä½ç½®ä¸”é—ªçƒç©ºç™½è®¡æ•°ä¸ä¸º0ï¼Œåˆ™æ­¤ä½ç½®ç»§ç»­ç©ºç™½æ˜¾ç¤º
C51 COMPILER V9.57.0.0   MAIN                                                              01/12/2026 15:52:53 PAGE 6   

 301   1          if(1 == clockSetLocation && blankCount>0)
 302   1          {
 303   2            smg(2,0xFF);
 304   2            blankCount--;
 305   2          }
 306   1          //å¦‚æœæ­£åœ¨è°ƒæ•´æ­¤ä½ç½®ä¸”é—ªçƒæ­£å¸¸è®¡æ•°ä¸ä¸º0ï¼Œåˆ™æ­¤ä½ç½®ç»§ç»­æ­£å¸¸æ˜¾ç¤º
 307   1          else if(1 == clockSetLocation && normalCount>0)
 308   1          {
 309   2            smg(2,table[shi%10]);
 310   2            normalCount--;
 311   2          }
 312   1          else if(1 == clockSetLocation)
 313   1          {
 314   2            blankCount = shanCount;//é—ªçƒæ ‡å¿—åˆå§‹åŒ–
 315   2            normalCount = shanCount;  
 316   2          }
 317   1          else
 318   1          smg(2,table[shi%10]);
 319   1      
 320   1        //- 
 321   1          smg(3,table[10]);
 322   1      
 323   1        //åˆ†çš„åä½ 
 324   1          //å¦‚æœæ­£åœ¨è°ƒæ•´æ­¤ä½ç½®ä¸”é—ªçƒç©ºç™½è®¡æ•°ä¸ä¸º0ï¼Œåˆ™æ­¤ä½ç½®ç»§ç»­ç©ºç™½æ˜¾ç¤º
 325   1          if(2==clockSetLocation && blankCount>0)
 326   1          {
 327   2            smg(4,0xFF);
 328   2            blankCount--;
 329   2          }
 330   1          //å¦‚æœæ­£åœ¨è°ƒæ•´æ­¤ä½ç½®ä¸”é—ªçƒæ­£å¸¸è®¡æ•°ä¸ä¸º0ï¼Œåˆ™æ­¤ä½ç½®ç»§ç»­æ­£å¸¸æ˜¾ç¤º
 331   1          else if(2 == clockSetLocation && normalCount > 0)
 332   1          {
 333   2            smg(4,table[fen/10]);
 334   2            normalCount--;
 335   2          }
 336   1          else if(2 == clockSetLocation)
 337   1          {
 338   2            blankCount = shanCount;//é—ªçƒæ ‡å¿—åˆå§‹åŒ–
 339   2            normalCount = shanCount;  
 340   2          }
 341   1          else
 342   1          smg(4,table[fen/10]);
 343   1      
 344   1        //åˆ†çš„ä¸ªä½ 
 345   1          //å¦‚æœæ­£åœ¨è°ƒæ•´æ­¤ä½ç½®ä¸”é—ªçƒç©ºç™½è®¡æ•°ä¸ä¸º0ï¼Œåˆ™æ­¤ä½ç½®ç»§ç»­ç©ºç™½æ˜¾ç¤º
 346   1          if(2 == clockSetLocation && blankCount>0)
 347   1          {
 348   2            smg(5,0xFF);
 349   2            blankCount--;
 350   2          }
 351   1          //å¦‚æœæ­£åœ¨è°ƒæ•´æ­¤ä½ç½®ä¸”é—ªçƒæ­£å¸¸è®¡æ•°ä¸ä¸º0ï¼Œåˆ™æ­¤ä½ç½®ç»§ç»­æ­£å¸¸æ˜¾ç¤º
 352   1          else if(2 == clockSetLocation && normalCount>0)
 353   1          {
 354   2            smg(5,table[fen%10]);
 355   2            normalCount--;
 356   2          }
 357   1          else if(2 == clockSetLocation)
 358   1          {
 359   2            blankCount = shanCount;//é—ªçƒæ ‡å¿—åˆå§‹åŒ–
 360   2            normalCount = shanCount;  
 361   2          }
 362   1          else
C51 COMPILER V9.57.0.0   MAIN                                                              01/12/2026 15:52:53 PAGE 7   

 363   1          smg(5,table[fen%10]);
 364   1      
 365   1        //- 
 366   1          smg(6,table[10]);
 367   1      
 368   1        //ç§’çš„åä½ 
 369   1          //å¦‚æœæ­£åœ¨è°ƒæ•´æ­¤ä½ç½®ä¸”é—ªçƒç©ºç™½è®¡æ•°ä¸ä¸º0ï¼Œåˆ™æ­¤ä½ç½®ç»§ç»­ç©ºç™½æ˜¾ç¤º
 370   1          if(3 == clockSetLocation && blankCount>0)
 371   1          {
 372   2            smg(7,0xFF);
 373   2            blankCount--;
 374   2          }
 375   1          //å¦‚æœæ­£åœ¨è°ƒæ•´æ­¤ä½ç½®ä¸”é—ªçƒæ­£å¸¸è®¡æ•°ä¸ä¸º0ï¼Œåˆ™æ­¤ä½ç½®ç»§ç»­æ­£å¸¸æ˜¾ç¤º
 376   1          else if(3 == clockSetLocation && normalCount>0)
 377   1          {
 378   2            smg(7,table[miao/10]);
 379   2            normalCount--;
 380   2          }
 381   1          else if(3 == clockSetLocation)
 382   1          {
 383   2            blankCount = shanCount;//é—ªçƒæ ‡å¿—åˆå§‹åŒ–
 384   2            normalCount = shanCount;  
 385   2          }
 386   1          else
 387   1          smg(7,table[miao/10]);
 388   1      
 389   1        //ç§’çš„ä¸ªä½ 
 390   1          //å¦‚æœæ­£åœ¨è°ƒæ•´æ­¤ä½ç½®ä¸”é—ªçƒç©ºç™½è®¡æ•°ä¸ä¸º0ï¼Œåˆ™æ­¤ä½ç½®ç»§ç»­ç©ºç™½æ˜¾ç¤º
 391   1          if(3 == clockSetLocation && blankCount>0)
 392   1          {
 393   2            smg(8,0xFF);
 394   2            blankCount--;
 395   2          }
 396   1          //å¦‚æœæ­£åœ¨è°ƒæ•´æ­¤ä½ç½®ä¸”é—ªçƒæ­£å¸¸è®¡æ•°ä¸ä¸º0ï¼Œåˆ™æ­¤ä½ç½®ç»§ç»­æ­£å¸¸æ˜¾ç¤º
 397   1          else if(3 == clockSetLocation && normalCount>0)
 398   1          {
 399   2            smg(8,table[miao%10]);
 400   2            normalCount--;
 401   2          }
 402   1          else if(3 == clockSetLocation)
 403   1          {
 404   2            blankCount = shanCount;//é—ªçƒæ ‡å¿—åˆå§‹åŒ–
 405   2            normalCount = shanCount;  
 406   2          }
 407   1          else
 408   1          smg(8,table[miao%10]);
 409   1      }
 410          
 411          void clock_set()//--------------------------è°ƒæ—¶(ä¸æ—¶é’ŸåŒç•Œé¢)
 412          {
 413   1        if(0==K1 && 0==whereNow)  //å¦‚æœæ­¤æ—¶åœ¨æ—¶é’Ÿç•Œé¢å¹¶æŒ‰ä¸‹äº†è°ƒæ—¶æŒ‰é”®K1
 414   1        {
 415   2          delay1ms(20);//æ¶ˆæŠ–
 416   2          if(0==K1)//å†æ¬¡æ£€æµ‹æŒ‰é”®çŠ¶æ€
 417   2          { 
 418   3            while(0==K1);//é•¿æŒ‰ç­‰å¾…
 419   3            delay1ms(20);//æ¶ˆæŠ–
 420   3            whereNow=1;
 421   3            clockSetLocation=1;
 422   3            TR0=0;
 423   3          }
 424   2        }
C51 COMPILER V9.57.0.0   MAIN                                                              01/12/2026 15:52:53 PAGE 8   

 425   1        if(1==whereNow) //è¿›å…¥è°ƒæ—¶ç•Œé¢ï¼Œ4ä¸ªç‹¬ç«‹æŒ‰é”®åŒ–èº«ä¸ºè°ƒæ—¶ç›¸å…³æŒ‰é’®
 426   1        {
 427   2          if(0==K1)//å¦‚æœæŒ‰ä¸‹K1:è°ƒæ•´ä½ç½®
 428   2          {
 429   3            delay1ms(20);//æ¶ˆæŠ–
 430   3            if(0==K1)//å†æ¬¡æ£€æµ‹æŒ‰é”®çŠ¶æ€
 431   3            {  
 432   4              while(0==K1);//é•¿æŒ‰åœç•™åœ¨æ­¤
 433   4              delay1ms(20);//æ¶ˆæŠ–
 434   4              clockSetLocation++;//ä½ç½®æ ‡å¿—+1
 435   4              if(clockSetLocation>3)
 436   4                clockSetLocation=1;
 437   4            }
 438   3          }
 439   2      
 440   2            if(1==clockSetLocation)//è¿›è¡Œâ€œæ—¶â€åŠ å‡
 441   2            {
 442   3              if(0==K2)//æŒ‰ä¸‹K2ï¼šæ•°å­—-1
 443   3              {
 444   4                delay1ms(20);//æ¶ˆæŠ–
 445   4                if(0==K2)//å†æ¬¡æ£€æµ‹æŒ‰é”®çŠ¶æ€
 446   4                {  
 447   5                  while(0==K2);//é•¿æŒ‰åœç•™åœ¨æ­¤
 448   5                  delay1ms(20);//æ¶ˆæŠ–
 449   5                  if(0==shi)
 450   5                    shi=24;
 451   5                  shi--;
 452   5                } 
 453   4              }
 454   3              if(0==K3)//æŒ‰ä¸‹K3ï¼šæ•°å­—+1
 455   3              {
 456   4                delay1ms(20);//æ¶ˆæŠ–
 457   4                if(0==K3)//å†æ¬¡æ£€æµ‹æŒ‰é”®çŠ¶æ€
 458   4                {  
 459   5                  while(0==K3);//é•¿æŒ‰åœç•™åœ¨æ­¤
 460   5                  delay1ms(20);//æ¶ˆæŠ–
 461   5                  shi++;
 462   5                  if(24==shi)
 463   5                    shi=0;
 464   5                } 
 465   4              }
 466   3            }
 467   2      
 468   2            if(2==clockSetLocation)//è¿›è¡Œâ€œåˆ†â€åŠ å‡
 469   2            {
 470   3              if(0==K2)//æŒ‰ä¸‹K2ï¼šæ•°å­—-1
 471   3              {
 472   4                delay1ms(20);//æ¶ˆæŠ–
 473   4                if(0==K2)//å†æ¬¡æ£€æµ‹æŒ‰é”®çŠ¶æ€
 474   4                {  
 475   5                  while(0==K2);//é•¿æŒ‰åœç•™åœ¨æ­¤
 476   5                  delay1ms(20);//æ¶ˆæŠ–
 477   5                  if(0==fen)
 478   5                    fen=60;
 479   5                  fen--;
 480   5                } 
 481   4              }
 482   3              if(0==K3)//æŒ‰ä¸‹K3ï¼šæ•°å­—+1
 483   3              {
 484   4                delay1ms(20);//æ¶ˆæŠ–
 485   4                if(0==K3)//å†æ¬¡æ£€æµ‹æŒ‰é”®çŠ¶æ€
 486   4                {  
C51 COMPILER V9.57.0.0   MAIN                                                              01/12/2026 15:52:53 PAGE 9   

 487   5                  while(0==K3);//é•¿æŒ‰åœç•™åœ¨æ­¤
 488   5                  delay1ms(20);//æ¶ˆæŠ–
 489   5                  fen++;
 490   5                  if(60==fen)
 491   5                    fen=0;
 492   5                } 
 493   4              }
 494   3            }
 495   2      
 496   2            if(3==clockSetLocation)//è¿›è¡Œâ€œç§’â€åŠ å‡
 497   2            {
 498   3              if(0==K2)//æŒ‰ä¸‹K2ï¼šæ•°å­—-1
 499   3              {
 500   4                delay1ms(20);//æ¶ˆæŠ–
 501   4                if(0==K2)//å†æ¬¡æ£€æµ‹æŒ‰é”®çŠ¶æ€
 502   4                {  
 503   5                  while(0==K2);//é•¿æŒ‰åœç•™åœ¨æ­¤
 504   5                  delay1ms(20);//æ¶ˆæŠ–
 505   5                  if(0==miao)
 506   5                    miao=60;
 507   5                  miao--;
 508   5                } 
 509   4              }
 510   3              if(0==K3)//æŒ‰ä¸‹K3ï¼šæ•°å­—+1
 511   3              {
 512   4                delay1ms(20);//æ¶ˆæŠ–
 513   4                if(0==K3)//å†æ¬¡æ£€æµ‹æŒ‰é”®çŠ¶æ€
 514   4                {  
 515   5                  while(0==K3);//é•¿æŒ‰åœç•™åœ¨æ­¤
 516   5                  delay1ms(20);//æ¶ˆæŠ–
 517   5                  miao++;
 518   5                  if(60==miao)
 519   5                    miao=0;
 520   5                } 
 521   4              }
 522   3            } 
 523   2         
 524   2          if(0==K4)//å¦‚æœæŒ‰ä¸‹K4ï¼šç¡®è®¤å¹¶é€€å‡ºè°ƒæ—¶æ¨¡å¼ï¼Œç„¶åè¿”å›æ—¶é’Ÿç•Œé¢
 525   2          {
 526   3            delay1ms(20);//æ¶ˆæŠ–
 527   3            if(0==K4)//å†æ¬¡æ£€æµ‹æŒ‰é”®çŠ¶æ€
 528   3            {  
 529   4              while(0==K4);//é•¿æŒ‰åœç•™åœ¨æ­¤
 530   4              delay1ms(20);//æ¶ˆæŠ–
 531   4              clockSetLocation=0;
 532   4              whereNow=0;
 533   4              TR0=1;
 534   4            }
 535   3          } 
 536   2        }
 537   1      }
 538          
 539          void alarm_display()//----------------------æ•°ç ç®¡åŠ¨æ€æ˜¾ç¤ºé—¹é’Ÿç•Œé¢
 540          {
 541   1        if(0==alarmOnOff)//å¦‚æœé—¹é’Ÿå…³é—­
 542   1          smg(1,0x8C);//'P.'è¡¨ç¤ºSTOP,é—¹é’Ÿå…³é—­
 543   1        if(1==alarmOnOff)//å¦‚æœé—¹é’Ÿå¼€å¯
 544   1          smg(1,0x86);//'E.'è¡¨ç¤ºOPEN,é—¹é’Ÿå¼€
 545   1        
 546   1      //æ—¶çš„åä½
 547   1        //å¦‚æœæ­£åœ¨è°ƒæ•´æ­¤ä½ç½®ä¸”é—ªçƒç©ºç™½è®¡æ•°ä¸ä¸º0ï¼Œåˆ™æ­¤ä½ç½®ç»§ç»­ç©ºç™½æ˜¾ç¤º
 548   1        if(1 == alarmSetLocation && blankCount>0)
C51 COMPILER V9.57.0.0   MAIN                                                              01/12/2026 15:52:53 PAGE 10  

 549   1        {
 550   2          smg(3,0xFF);
 551   2          blankCount--;
 552   2        }
 553   1        //å¦‚æœæ­£åœ¨è°ƒæ•´æ­¤ä½ç½®ä¸”é—ªçƒæ­£å¸¸è®¡æ•°ä¸ä¸º0ï¼Œåˆ™æ­¤ä½ç½®ç»§ç»­æ­£å¸¸æ˜¾ç¤º
 554   1        else if(1 == alarmSetLocation && normalCount>0)
 555   1        {
 556   2          smg(3,table[shi1/10]);
 557   2          normalCount--;
 558   2        }
 559   1        else if(1 == alarmSetLocation)
 560   1        {
 561   2          blankCount=shanCount;//é—ªçƒæ ‡å¿—åˆå§‹åŒ–
 562   2          normalCount=shanCount;  
 563   2        }
 564   1        else
 565   1        smg(3,table[shi1/10]);
 566   1        
 567   1      //æ—¶çš„ä¸ªä½
 568   1        //å¦‚æœæ­£åœ¨è°ƒæ•´æ­¤ä½ç½®ä¸”é—ªçƒç©ºç™½è®¡æ•°ä¸ä¸º0ï¼Œåˆ™æ­¤ä½ç½®ç»§ç»­ç©ºç™½æ˜¾ç¤º
 569   1        if(1 == alarmSetLocation && blankCount>0)
 570   1        {
 571   2          smg(4,0xFF);
 572   2          blankCount--;
 573   2        }
 574   1        //å¦‚æœæ­£åœ¨è°ƒæ•´æ­¤ä½ç½®ä¸”é—ªçƒæ­£å¸¸è®¡æ•°ä¸ä¸º0ï¼Œåˆ™æ­¤ä½ç½®ç»§ç»­æ­£å¸¸æ˜¾ç¤º
 575   1        else if(1 == alarmSetLocation && normalCount>0)
 576   1        {
 577   2          smg(4,table_dot[shi1%10]);
 578   2          normalCount--;
 579   2        }
 580   1        else if(1 == alarmSetLocation)
 581   1        {
 582   2          blankCount=shanCount;//é—ªçƒæ ‡å¿—åˆå§‹åŒ–
 583   2          normalCount=shanCount;  
 584   2        }
 585   1        else
 586   1        smg(4,table_dot[shi1%10]);
 587   1      //åˆ†çš„åä½
 588   1        //å¦‚æœæ­£åœ¨è°ƒæ•´æ­¤ä½ç½®ä¸”é—ªçƒç©ºç™½è®¡æ•°ä¸ä¸º0ï¼Œåˆ™æ­¤ä½ç½®ç»§ç»­ç©ºç™½æ˜¾ç¤º
 589   1        if(2 == alarmSetLocation && blankCount>0)
 590   1        {
 591   2          smg(5,0xFF);
 592   2          blankCount--;
 593   2        }
 594   1        //å¦‚æœæ­£åœ¨è°ƒæ•´æ­¤ä½ç½®ä¸”é—ªçƒæ­£å¸¸è®¡æ•°ä¸ä¸º0ï¼Œåˆ™æ­¤ä½ç½®ç»§ç»­æ­£å¸¸æ˜¾ç¤º
 595   1        else if(2 == alarmSetLocation && normalCount>0)
 596   1        {
 597   2          smg(5,table[fen1/10]);
 598   2          normalCount--;
 599   2        }
 600   1        else if(2==alarmSetLocation)
 601   1        {
 602   2          blankCount=shanCount;//é—ªçƒæ ‡å¿—åˆå§‹åŒ–
 603   2          normalCount=shanCount;  
 604   2        }
 605   1        else
 606   1        smg(5,table[fen1/10]);
 607   1        
 608   1      //åˆ†çš„ä¸ªä½
 609   1        //å¦‚æœæ­£åœ¨è°ƒæ•´æ­¤ä½ç½®ä¸”é—ªçƒç©ºç™½è®¡æ•°ä¸ä¸º0ï¼Œåˆ™æ­¤ä½ç½®ç»§ç»­ç©ºç™½æ˜¾ç¤º
 610   1        if(2 == alarmSetLocation && blankCount>0)
C51 COMPILER V9.57.0.0   MAIN                                                              01/12/2026 15:52:53 PAGE 11  

 611   1        {
 612   2          smg(6,0xFF);
 613   2          blankCount--;
 614   2        }
 615   1        //å¦‚æœæ­£åœ¨è°ƒæ•´æ­¤ä½ç½®ä¸”é—ªçƒæ­£å¸¸è®¡æ•°ä¸ä¸º0ï¼Œåˆ™æ­¤ä½ç½®ç»§ç»­æ­£å¸¸æ˜¾ç¤º
 616   1        else if(2 == alarmSetLocation && normalCount>0)
 617   1        {
 618   2          smg(6,table_dot[fen1%10]);
 619   2          normalCount--;
 620   2        }
 621   1        else if(2 == alarmSetLocation)
 622   1        {
 623   2          blankCount=shanCount;//é—ªçƒæ ‡å¿—åˆå§‹åŒ–
 624   2          normalCount=shanCount;  
 625   2        }
 626   1        else
 627   1        smg(6,table_dot[fen1%10]);
 628   1        
 629   1      //ç§’çš„åä½
 630   1        //å¦‚æœæ­£åœ¨è°ƒæ•´æ­¤ä½ç½®ä¸”é—ªçƒç©ºç™½è®¡æ•°ä¸ä¸º0ï¼Œåˆ™æ­¤ä½ç½®ç»§ç»­ç©ºç™½æ˜¾ç¤º
 631   1        if(3 == alarmSetLocation && blankCount>0)
 632   1        {
 633   2          smg(7,0xFF);
 634   2          blankCount--;
 635   2        }
 636   1        //å¦‚æœæ­£åœ¨è°ƒæ•´æ­¤ä½ç½®ä¸”é—ªçƒæ­£å¸¸è®¡æ•°ä¸ä¸º0ï¼Œåˆ™æ­¤ä½ç½®ç»§ç»­æ­£å¸¸æ˜¾ç¤º
 637   1        else if(3 == alarmSetLocation && normalCount>0)
 638   1        {
 639   2          smg(7,table[miao1/10]);
 640   2          normalCount--;
 641   2        }
 642   1        else if(3 == alarmSetLocation)
 643   1        {
 644   2          blankCount=shanCount;//é—ªçƒæ ‡å¿—åˆå§‹åŒ–
 645   2          normalCount=shanCount;  
 646   2        }
 647   1        else
 648   1        smg(7,table[miao1/10]);
 649   1        
 650   1      //ç§’çš„ä¸ªä½
 651   1        //å¦‚æœæ­£åœ¨è°ƒæ•´æ­¤ä½ç½®ä¸”é—ªçƒç©ºç™½è®¡æ•°ä¸ä¸º0ï¼Œåˆ™æ­¤ä½ç½®ç»§ç»­ç©ºç™½æ˜¾ç¤º
 652   1        if(3 == alarmSetLocation && blankCount>0)
 653   1        {
 654   2          smg(8,0xFF);
 655   2          blankCount--;
 656   2        }
 657   1        //å¦‚æœæ­£åœ¨è°ƒæ•´æ­¤ä½ç½®ä¸”é—ªçƒæ­£å¸¸è®¡æ•°ä¸ä¸º0ï¼Œåˆ™æ­¤ä½ç½®ç»§ç»­æ­£å¸¸æ˜¾ç¤º
 658   1        else if(3 == alarmSetLocation && normalCount>0)
 659   1        {
 660   2          smg(8,table_dot[miao1%10]);
 661   2          normalCount--;
 662   2        }
 663   1        else if(3==alarmSetLocation)
 664   1        {
 665   2          blankCount=shanCount;//é—ªçƒæ ‡å¿—åˆå§‹åŒ–
 666   2          normalCount=shanCount;  
 667   2        }
 668   1        else
 669   1        smg(8,table_dot[miao1%10]);
 670   1      }
 671          
 672          void alarm_set()//----------------------é—¹é’Ÿè®¾ç½®
C51 COMPILER V9.57.0.0   MAIN                                                              01/12/2026 15:52:53 PAGE 12  

 673          {
 674   1        if(0==whereNow && 0==K2)//å¦‚æœæ­¤æ—¶åœ¨æ—¶é’Ÿç•Œé¢å¹¶æŒ‰ä¸‹äº†é—¹é’ŸæŒ‰é”®K2
 675   1        {
 676   2          delay1ms(20);//æ¶ˆæŠ–
 677   2          if(0==K2)//å†æ¬¡æ£€æµ‹æŒ‰é”®çŠ¶æ€
 678   2          { 
 679   3            while(0==K2);//é•¿æŒ‰ç­‰å¾…
 680   3            delay1ms(20);//æ¶ˆæŠ–
 681   3            whereNow=2;
 682   3          }
 683   2        }
 684   1        
 685   1        if(2==whereNow)//å¦‚æœæ­¤æ—¶åœ¨é—¹é’Ÿç•Œé¢ï¼Œé‚£ä¹ˆå››ä¸ªç‹¬ç«‹æŒ‰é”®åŒ–èº«ä¸ºé—¹é’Ÿç›¸å…³æŒ‰é”®
 686   1        {
 687   2          if(0==K1)//å¦‚æœæŒ‰ä¸‹K1:è°ƒæ•´ä½ç½®
 688   2          {
 689   3            delay1ms(20);//æ¶ˆæŠ–
 690   3            if(0==K1)//å†æ¬¡æ£€æµ‹æŒ‰é”®çŠ¶æ€
 691   3            {  
 692   4              while(0==K1);//é•¿æŒ‰åœç•™åœ¨æ­¤
 693   4              delay1ms(20);//æ¶ˆæŠ–
 694   4              alarmSetLocation++;//ä½ç½®æ ‡å¿—+1
 695   4              if(4==alarmSetLocation)
 696   4                alarmOnOff=!alarmOnOff;
 697   4              if(alarmSetLocation>3)
 698   4                alarmSetLocation=0;   
 699   4            }
 700   3          }   
 701   2      
 702   2            if(1==alarmSetLocation)//è¿›è¡Œâ€œæ—¶â€åŠ å‡
 703   2            {
 704   3              if(0==K2)//æŒ‰ä¸‹K2ï¼šæ•°å­—-1
 705   3              {
 706   4                delay1ms(20);//æ¶ˆæŠ–
 707   4                if(0==K2)//å†æ¬¡æ£€æµ‹æŒ‰é”®çŠ¶æ€
 708   4                {  
 709   5                  while(0==K2);//é•¿æŒ‰åœç•™åœ¨æ­¤
 710   5                  delay1ms(20);//æ¶ˆæŠ–
 711   5                  if(0==shi1)shi1=24;
 712   5                  shi1--;
 713   5                } 
 714   4              }
 715   3              if(0==K3)//æŒ‰ä¸‹K3ï¼šæ•°å­—+1
 716   3              {
 717   4                delay1ms(20);//æ¶ˆæŠ–
 718   4                if(0==K3)//å†æ¬¡æ£€æµ‹æŒ‰é”®çŠ¶æ€
 719   4                {  
 720   5                  while(0==K3);//é•¿æŒ‰åœç•™åœ¨æ­¤
 721   5                  delay1ms(20);//æ¶ˆæŠ–
 722   5                  shi1++;
 723   5                  if(24==shi1)shi1=0;
 724   5                } 
 725   4              }
 726   3            }
 727   2      
 728   2            if(2==alarmSetLocation)//è¿›è¡Œâ€œåˆ†â€åŠ å‡
 729   2            {
 730   3              if(0==K2)//æŒ‰ä¸‹K2ï¼šæ•°å­—-1
 731   3              {
 732   4                delay1ms(20);//æ¶ˆæŠ–
 733   4                if(0==K2)//å†æ¬¡æ£€æµ‹æŒ‰é”®çŠ¶æ€
 734   4                {  
C51 COMPILER V9.57.0.0   MAIN                                                              01/12/2026 15:52:53 PAGE 13  

 735   5                  while(0==K2);//é•¿æŒ‰åœç•™åœ¨æ­¤
 736   5                  delay1ms(20);//æ¶ˆæŠ–
 737   5                  if(0==fen1)fen1=60;
 738   5                  fen1--;
 739   5                } 
 740   4              }
 741   3              if(0==K3)//æŒ‰ä¸‹K3ï¼šæ•°å­—+1
 742   3              {
 743   4                delay1ms(20);//æ¶ˆæŠ–
 744   4                if(0==K3)//å†æ¬¡æ£€æµ‹æŒ‰é”®çŠ¶æ€
 745   4                {  
 746   5                  while(0==K3);//é•¿æŒ‰åœç•™åœ¨æ­¤
 747   5                  delay1ms(20);//æ¶ˆæŠ–
 748   5                  fen1++;
 749   5                  if(60==fen1)fen1=0;
 750   5                } 
 751   4              }
 752   3            }
 753   2      
 754   2            if(3==alarmSetLocation)//è¿›è¡Œâ€œç§’â€åŠ å‡
 755   2            {
 756   3              if(0==K2)//æŒ‰ä¸‹K2ï¼šæ•°å­—-1
 757   3              {
 758   4                delay1ms(20);//æ¶ˆæŠ–
 759   4                if(0==K2)//å†æ¬¡æ£€æµ‹æŒ‰é”®çŠ¶æ€
 760   4                {  
 761   5                  while(0==K2);//é•¿æŒ‰åœç•™åœ¨æ­¤
 762   5                  delay1ms(20);//æ¶ˆæŠ–
 763   5                  if(0==miao1)miao1=60;
 764   5                  miao1--;
 765   5                } 
 766   4              }
 767   3              if(0==K3)//æŒ‰ä¸‹K3ï¼šæ•°å­—+1
 768   3              {
 769   4                delay1ms(20);//æ¶ˆæŠ–
 770   4                if(0==K3)//å†æ¬¡æ£€æµ‹æŒ‰é”®çŠ¶æ€
 771   4                {  
 772   5                  while(0==K3);//é•¿æŒ‰åœç•™åœ¨æ­¤
 773   5                  delay1ms(20);//æ¶ˆæŠ–
 774   5                  miao1++;
 775   5                  if(60==miao1)miao1=0;
 776   5                } 
 777   4              } 
 778   3            }
 779   2      
 780   2            if(0==K4)//å¦‚æœæŒ‰ä¸‹K4ï¼šç¡®è®¤å¹¶é€€å‡ºé—¹é’Ÿç•Œé¢ï¼Œç„¶åè¿”å›æ—¶é’Ÿç•Œé¢
 781   2              {
 782   3              delay1ms(20);//æ¶ˆæŠ–
 783   3              if(0==K4)//å†æ¬¡æ£€æµ‹æŒ‰é”®çŠ¶æ€
 784   3              {  
 785   4                while(0==K4);//é•¿æŒ‰åœç•™åœ¨æ­¤
 786   4                delay1ms(20);//æ¶ˆæŠ–
 787   4                alarmSetLocation=0;
 788   4                whereNow=0;
 789   4              }
 790   3            } 
 791   2        } 
 792   1      }
 793          
 794          void alarm_exe()//---------------------------------------------é—¹é’Ÿæ‰§è¡Œ
 795          //åªæœ‰å½“ä»¥ä¸‹æ¡ä»¶ã€éƒ½æ»¡è¶³ã€‘çš„æ—¶å€™ï¼Œé—¹é’Ÿæ‰ä¼šå“èµ·ï¼š
 796          //1ã€æ—¶é’Ÿçš„æ—¶åˆ†ç§’=é—¹é’Ÿçš„æ—¶åˆ†ç§’
C51 COMPILER V9.57.0.0   MAIN                                                              01/12/2026 15:52:53 PAGE 14  

 797          //2ã€é—¹é’Ÿå¤„äºå¼€å¯çŠ¶æ€
 798          //3ã€å½“å‰åœ¨æ—¶é’Ÿè¿è¡Œç•Œé¢
 799          //
 800          //æ³¨ï¼šæŒ‰ä¸‹ç‹¬ç«‹æŒ‰é”®ä¸­çš„ä»»æ„ä¸€ä¸ªå¹¶æ¾å¼€ï¼Œå¯åœæ­¢é—¹é’Ÿ
 801          { 
 802   1        if(shi==shi1 && fen==fen1 && miao==miao1 && 1==alarmOnOff && 0==whereNow)
 803   1        {
 804   2          while(1==K1 && 1==K2 && 1==K3 && 1==K4)
 805   2          {
 806   3          BEEP=~BEEP;
 807   3          smg(1,0x88);//'A'
 808   3            BEEP=~BEEP;
 809   3          smg(2,0x47);//'L.'
 810   3            BEEP=~BEEP;
 811   3          smg(3,table[shi1/10]);
 812   3            BEEP=~BEEP;
 813   3          smg(4,table_dot[shi1%10]);
 814   3            BEEP=~BEEP;
 815   3          smg(5,table[fen1/10]);
 816   3            BEEP=~BEEP;
 817   3          smg(6,table_dot[fen1%10]);
 818   3            BEEP=~BEEP;
 819   3          smg(7,table[miao1/10]);
 820   3            BEEP=~BEEP;
 821   3          smg(8,table[miao1%10]);
 822   3            BEEP=~BEEP;
 823   3          }
 824   2          while(0==K1 || 0==K2 || 0==K3 || 0==K4);//ç­‰å¾…ï¼Œç›´è‡³æ¾å¼€ç‹¬ç«‹æŒ‰é”®
 825   2          delay1ms(20);
 826   2          BEEP=1;
 827   2        }
 828   1      }
 829          
 830          void cld_display()//------------------------æ•°ç ç®¡åŠ¨æ€æ˜¾ç¤ºæ—¥å†ç•Œé¢
 831          {
 832   1      //å¹´çš„åƒä½
 833   1        //å¦‚æœæ­£åœ¨è°ƒæ•´æ­¤ä½ç½®ä¸”é—ªçƒç©ºç™½è®¡æ•°ä¸ä¸º0ï¼Œåˆ™æ­¤ä½ç½®ç»§ç»­ç©ºç™½æ˜¾ç¤º
 834   1        if(1 == cldSetLocation && blankCount>0)
 835   1        {
 836   2          smg(1,0xFF);
 837   2          blankCount--;
 838   2        }
 839   1        //å¦‚æœæ­£åœ¨è°ƒæ•´æ­¤ä½ç½®ä¸”é—ªçƒæ­£å¸¸è®¡æ•°ä¸ä¸º0ï¼Œåˆ™æ­¤ä½ç½®ç»§ç»­æ­£å¸¸æ˜¾ç¤º
 840   1        else if(1 == cldSetLocation && normalCount>0)
 841   1        {
 842   2          smg(1,table[year/1000]);
 843   2          normalCount--;
 844   2        }
 845   1        else if(1 == cldSetLocation)
 846   1        {
 847   2          blankCount=shanCount;//é—ªçƒæ ‡å¿—åˆå§‹åŒ–
 848   2          normalCount=shanCount;  
 849   2        }
 850   1        else
 851   1        smg(1,table[year/1000]);
 852   1        
 853   1      //å¹´çš„ç™¾ä½
 854   1        //å¦‚æœæ­£åœ¨è°ƒæ•´æ­¤ä½ç½®ä¸”é—ªçƒç©ºç™½è®¡æ•°ä¸ä¸º0ï¼Œåˆ™æ­¤ä½ç½®ç»§ç»­ç©ºç™½æ˜¾ç¤º
 855   1        if(1 == cldSetLocation && blankCount>0)
 856   1        {
 857   2          smg(2,0xFF);
 858   2          blankCount--;
C51 COMPILER V9.57.0.0   MAIN                                                              01/12/2026 15:52:53 PAGE 15  

 859   2        }
 860   1        //å¦‚æœæ­£åœ¨è°ƒæ•´æ­¤ä½ç½®ä¸”é—ªçƒæ­£å¸¸è®¡æ•°ä¸ä¸º0ï¼Œåˆ™æ­¤ä½ç½®ç»§ç»­æ­£å¸¸æ˜¾ç¤º
 861   1        else if(1 == cldSetLocation && normalCount>0)
 862   1        {
 863   2          smg(2,table[year/100%10]);
 864   2          normalCount--;
 865   2        }
 866   1        else if(1 == cldSetLocation)
 867   1        {
 868   2          blankCount=shanCount;//é—ªçƒæ ‡å¿—åˆå§‹åŒ–
 869   2          normalCount=shanCount;  
 870   2        }
 871   1        else
 872   1        smg(2,table[year/100%10]);
 873   1        
 874   1      //å¹´çš„åä½
 875   1        //å¦‚æœæ­£åœ¨è°ƒæ•´æ­¤ä½ç½®ä¸”é—ªçƒç©ºç™½è®¡æ•°ä¸ä¸º0ï¼Œåˆ™æ­¤ä½ç½®ç»§ç»­ç©ºç™½æ˜¾ç¤º
 876   1        if(1 == cldSetLocation && blankCount>0)
 877   1        {
 878   2          smg(3,0xFF);
 879   2          blankCount--;
 880   2        }
 881   1        //å¦‚æœæ­£åœ¨è°ƒæ•´æ­¤ä½ç½®ä¸”é—ªçƒæ­£å¸¸è®¡æ•°ä¸ä¸º0ï¼Œåˆ™æ­¤ä½ç½®ç»§ç»­æ­£å¸¸æ˜¾ç¤º
 882   1        else if(1 == cldSetLocation && normalCount>0)
 883   1        {
 884   2          smg(3,table[year%100/10]);
 885   2          normalCount--;
 886   2        }
 887   1        else if(1 == cldSetLocation)
 888   1        {
 889   2          blankCount=shanCount;//é—ªçƒæ ‡å¿—åˆå§‹åŒ–
 890   2          normalCount=shanCount;  
 891   2        }
 892   1        else
 893   1        smg(3,table[year%100/10]);
 894   1        
 895   1      //å¹´çš„ä¸ªä½
 896   1        //å¦‚æœæ­£åœ¨è°ƒæ•´æ­¤ä½ç½®ä¸”é—ªçƒç©ºç™½è®¡æ•°ä¸ä¸º0ï¼Œåˆ™æ­¤ä½ç½®ç»§ç»­ç©ºç™½æ˜¾ç¤º
 897   1        if(1 == cldSetLocation && blankCount>0)
 898   1        {
 899   2          smg(4,0xFF);
 900   2          blankCount--;
 901   2        }
 902   1        //å¦‚æœæ­£åœ¨è°ƒæ•´æ­¤ä½ç½®ä¸”é—ªçƒæ­£å¸¸è®¡æ•°ä¸ä¸º0ï¼Œåˆ™æ­¤ä½ç½®ç»§ç»­æ­£å¸¸æ˜¾ç¤º
 903   1        else if(1 == cldSetLocation && normalCount>0)
 904   1        {
 905   2          smg(4,table_dot[year%10]);
 906   2          normalCount--;
 907   2        }
 908   1        else if(1 == cldSetLocation)
 909   1        {
 910   2          blankCount=shanCount;//é—ªçƒæ ‡å¿—åˆå§‹åŒ–
 911   2          normalCount=shanCount;  
 912   2        }
 913   1        else
 914   1        smg(4,table_dot[year%10]);
 915   1        
 916   1      //æœˆçš„åä½
 917   1        //å¦‚æœæ­£åœ¨è°ƒæ•´æ­¤ä½ç½®ä¸”é—ªçƒç©ºç™½è®¡æ•°ä¸ä¸º0ï¼Œåˆ™æ­¤ä½ç½®ç»§ç»­ç©ºç™½æ˜¾ç¤º
 918   1        if(2 == cldSetLocation && blankCount>0)
 919   1        {
 920   2          smg(5,0xFF);
C51 COMPILER V9.57.0.0   MAIN                                                              01/12/2026 15:52:53 PAGE 16  

 921   2          blankCount--;
 922   2        }
 923   1        //å¦‚æœæ­£åœ¨è°ƒæ•´æ­¤ä½ç½®ä¸”é—ªçƒæ­£å¸¸è®¡æ•°ä¸ä¸º0ï¼Œåˆ™æ­¤ä½ç½®ç»§ç»­æ­£å¸¸æ˜¾ç¤º
 924   1        else if(2 == cldSetLocation && normalCount>0)
 925   1        {
 926   2          smg(5,table[month/10]);
 927   2          normalCount--;
 928   2        }else if(2 == cldSetLocation)
 929   1        {
 930   2          blankCount=shanCount;//é—ªçƒæ ‡å¿—åˆå§‹åŒ–
 931   2          normalCount=shanCount;  
 932   2        }
 933   1        else
 934   1        smg(5,table[month/10]);
 935   1        
 936   1      //æœˆçš„ä¸ªä½
 937   1        //å¦‚æœæ­£åœ¨è°ƒæ•´æ­¤ä½ç½®ä¸”é—ªçƒç©ºç™½è®¡æ•°ä¸ä¸º0ï¼Œåˆ™æ­¤ä½ç½®ç»§ç»­ç©ºç™½æ˜¾ç¤º
 938   1        if(2 == cldSetLocation && blankCount>0)
 939   1        {
 940   2          smg(6,0xFF);
 941   2          blankCount--;
 942   2        }
 943   1        //å¦‚æœæ­£åœ¨è°ƒæ•´æ­¤ä½ç½®ä¸”é—ªçƒæ­£å¸¸è®¡æ•°ä¸ä¸º0ï¼Œåˆ™æ­¤ä½ç½®ç»§ç»­æ­£å¸¸æ˜¾ç¤º
 944   1        else if(2 == cldSetLocation && normalCount>0)
 945   1        {
 946   2          smg(6,table_dot[month%10]);
 947   2          normalCount--;
 948   2        }
 949   1        else if(2==cldSetLocation)
 950   1        {
 951   2          blankCount=shanCount;//é—ªçƒæ ‡å¿—åˆå§‹åŒ–
 952   2          normalCount=shanCount;  
 953   2        }
 954   1        else
 955   1        smg(6,table_dot[month%10]);
 956   1        
 957   1      //æ—¥çš„åä½
 958   1        //å¦‚æœæ­£åœ¨è°ƒæ•´æ­¤ä½ç½®ä¸”é—ªçƒç©ºç™½è®¡æ•°ä¸ä¸º0ï¼Œåˆ™æ­¤ä½ç½®ç»§ç»­ç©ºç™½æ˜¾ç¤º
 959   1        if(3 == cldSetLocation && blankCount>0)
 960   1        {
 961   2          smg(7,0xFF);
 962   2          blankCount--;
 963   2        }
 964   1        //å¦‚æœæ­£åœ¨è°ƒæ•´æ­¤ä½ç½®ä¸”é—ªçƒæ­£å¸¸è®¡æ•°ä¸ä¸º0ï¼Œåˆ™æ­¤ä½ç½®ç»§ç»­æ­£å¸¸æ˜¾ç¤º
 965   1        else if(3 == cldSetLocation && normalCount>0)
 966   1        {
 967   2          smg(7,table[day/10]);
 968   2          normalCount--;
 969   2        }
 970   1        else if(3 == cldSetLocation)
 971   1        {
 972   2          blankCount=shanCount;//é—ªçƒæ ‡å¿—åˆå§‹åŒ–
 973   2          normalCount=shanCount;  
 974   2        }
 975   1        else
 976   1        smg(7,table[day/10]);
 977   1        
 978   1      //æ—¥çš„ä¸ªä½
 979   1        //å¦‚æœæ­£åœ¨è°ƒæ•´æ­¤ä½ç½®ä¸”é—ªçƒç©ºç™½è®¡æ•°ä¸ä¸º0ï¼Œåˆ™æ­¤ä½ç½®ç»§ç»­ç©ºç™½æ˜¾ç¤º
 980   1        if(3 == cldSetLocation && blankCount>0)
 981   1        {
 982   2          smg(8,0xFF);
C51 COMPILER V9.57.0.0   MAIN                                                              01/12/2026 15:52:53 PAGE 17  

 983   2          blankCount--;
 984   2        }
 985   1        //å¦‚æœæ­£åœ¨è°ƒæ•´æ­¤ä½ç½®ä¸”é—ªçƒæ­£å¸¸è®¡æ•°ä¸ä¸º0ï¼Œåˆ™æ­¤ä½ç½®ç»§ç»­æ­£å¸¸æ˜¾ç¤º
 986   1        else if(3 == cldSetLocation && normalCount>0)
 987   1        {
 988   2          smg(8,table_dot[day%10]);
 989   2          normalCount--;
 990   2        }
 991   1        else if(3 == cldSetLocation)
 992   1        {
 993   2          blankCount=shanCount;//é—ªçƒæ ‡å¿—åˆå§‹åŒ–
 994   2          normalCount=shanCount;  
 995   2        }
 996   1        else
 997   1        smg(8,table_dot[day%10]); 
 998   1      }
 999          
1000          void cld_set()//---------------------------æ—¥å†è®¾ç½®
1001          {
1002   1        if(0==whereNow && 0==K3)//å¦‚æœæ­¤æ—¶åœ¨æ—¶é’Ÿç•Œé¢å¹¶æŒ‰ä¸‹äº†æ—¥å†æŒ‰é”®K3
1003   1        {
1004   2          delay1ms(20);//æ¶ˆæŠ–
1005   2          if(0==K3)//å†æ¬¡æ£€æµ‹æŒ‰é”®çŠ¶æ€
1006   2          { 
1007   3            while(0==K3);//é•¿æŒ‰ç­‰å¾…
1008   3            delay1ms(20);//æ¶ˆæŠ–
1009   3            whereNow=3;
1010   3          }
1011   2        }
1012   1        
1013   1        if(3==whereNow)//å¦‚æœæ­¤æ—¶åœ¨æ—¥å†ç•Œé¢ï¼Œé‚£ä¹ˆå››ä¸ªç‹¬ç«‹æŒ‰é”®åŒ–èº«ä¸ºæ—¥å†ç›¸å…³æŒ‰é”®
1014   1        {
1015   2          if(0==K1)//å¦‚æœæŒ‰ä¸‹K1:è°ƒæ•´ä½ç½®
1016   2          {
1017   3            delay1ms(20);//æ¶ˆæŠ–
1018   3            if(0==K1)//å†æ¬¡æ£€æµ‹æŒ‰é”®çŠ¶æ€
1019   3            {  
1020   4              while(0==K1);//é•¿æŒ‰åœç•™åœ¨æ­¤
1021   4              delay1ms(20);//æ¶ˆæŠ–
1022   4              cldSetLocation++;//ä½ç½®æ ‡å¿—+1
1023   4              if(cldSetLocation>3)
1024   4                cldSetLocation=1;   
1025   4            }
1026   3          }   
1027   2      
1028   2            if(1==cldSetLocation)//è¿›è¡Œâ€œå¹´â€åŠ å‡
1029   2            {
1030   3              if(0==K2)//æŒ‰ä¸‹K2ï¼šæ•°å­—-1
1031   3              {
1032   4                delay1ms(20);//æ¶ˆæŠ–
1033   4                if(0==K2)//å†æ¬¡æ£€æµ‹æŒ‰é”®çŠ¶æ€
1034   4                {  
1035   5                  while(0==K2);//é•¿æŒ‰åœç•™åœ¨æ­¤
1036   5                  delay1ms(20);//æ¶ˆæŠ–
1037   5                  if(minYear==year)
1038   5                    year=minYear+1;//è®¾å®šæ—¥å†å¹´ä»½å‡åˆ°æœ€ä½é™åº¦åˆ™æ— æ³•å†å‡
1039   5                  year--;
1040   5                } 
1041   4              }
1042   3              if(0==K3)//æŒ‰ä¸‹K3ï¼šæ•°å­—+1
1043   3              {
1044   4                delay1ms(20);//æ¶ˆæŠ–
C51 COMPILER V9.57.0.0   MAIN                                                              01/12/2026 15:52:53 PAGE 18  

1045   4                if(0==K3)//å†æ¬¡æ£€æµ‹æŒ‰é”®çŠ¶æ€
1046   4                {  
1047   5                  while(0==K3);//é•¿æŒ‰åœç•™åœ¨æ­¤
1048   5                  delay1ms(20);//æ¶ˆæŠ–
1049   5                  year++;
1050   5                  if(maxYear+1==year)
1051   5                    year=maxYear;//è®¾å®šæ—¥å†å¹´ä»½åŠ åˆ°æœ€å¤§é™åº¦åˆ™æ— æ³•å†åŠ 
1052   5                } 
1053   4              }
1054   3            }
1055   2      
1056   2            if(2==cldSetLocation)//è¿›è¡Œâ€œæœˆâ€åŠ å‡
1057   2            {
1058   3              if(0==K2)//æŒ‰ä¸‹K2ï¼šæ•°å­—-1
1059   3              {
1060   4                delay1ms(20);//æ¶ˆæŠ–
1061   4                if(0==K2)//å†æ¬¡æ£€æµ‹æŒ‰é”®çŠ¶æ€
1062   4                {  
1063   5                  while(0==K2);//é•¿æŒ‰åœç•™åœ¨æ­¤
1064   5                  delay1ms(20);//æ¶ˆæŠ–
1065   5                  if(1==month)
1066   5                    month=13;
1067   5                  month--;
1068   5                } 
1069   4              }
1070   3              if(0==K3)//æŒ‰ä¸‹K3ï¼šæ•°å­—+1
1071   3              {
1072   4                delay1ms(20);//æ¶ˆæŠ–
1073   4                if(0==K3)//å†æ¬¡æ£€æµ‹æŒ‰é”®çŠ¶æ€
1074   4                {  
1075   5                  while(0==K3);//é•¿æŒ‰åœç•™åœ¨æ­¤
1076   5                  delay1ms(20);//æ¶ˆæŠ–
1077   5                  month++;
1078   5                  if(13==month)
1079   5                    month=1;
1080   5                } 
1081   4              }
1082   3            }
1083   2      
1084   2            if(3==cldSetLocation)//è¿›è¡Œâ€œæ—¥â€åŠ å‡
1085   2            {
1086   3              if(0==K2)//æŒ‰ä¸‹K2ï¼šæ•°å­—-1
1087   3              {
1088   4                delay1ms(20);//æ¶ˆæŠ–
1089   4                if(0==K2)//å†æ¬¡æ£€æµ‹æŒ‰é”®çŠ¶æ€
1090   4                {  
1091   5                  while(0==K2);//é•¿æŒ‰åœç•™åœ¨æ­¤
1092   5                  delay1ms(20);//æ¶ˆæŠ–
1093   5                  if(day<=1)
1094   5                  {         
1095   6                    if(0==isLeapYear)//å¦‚æœæ˜¯å¹³å¹´
1096   6                      day=commonYearTable[month]+1;
1097   6                    if(1==isLeapYear)//å¦‚æœæ˜¯é—°å¹´
1098   6                      day=leapYearTable[month]+1; 
1099   6                  } 
1100   5                  day--;
1101   5                } 
1102   4              }
1103   3              if(0==K3)//æŒ‰ä¸‹K3ï¼šæ•°å­—+1
1104   3              {
1105   4                delay1ms(20);//æ¶ˆæŠ–
1106   4                if(0==K3)//å†æ¬¡æ£€æµ‹æŒ‰é”®çŠ¶æ€
C51 COMPILER V9.57.0.0   MAIN                                                              01/12/2026 15:52:53 PAGE 19  

1107   4                {  
1108   5                  while(0==K3);//é•¿æŒ‰åœç•™åœ¨æ­¤
1109   5                  delay1ms(20);//æ¶ˆæŠ–
1110   5                  day++;          
1111   5                  if(0==isLeapYear)//å¦‚æœæ˜¯å¹³å¹´
1112   5                  {
1113   6                    if(day>commonYearTable[month])
1114   6                      day=1;
1115   6                  }
1116   5                  if(1==isLeapYear)//å¦‚æœæ˜¯é—°å¹´
1117   5                  {
1118   6                    if(day>leapYearTable[month])
1119   6                      day=1;
1120   6                  }
1121   5                } 
1122   4              } 
1123   3            }
1124   2      
1125   2            if(0==K4)//å¦‚æœæŒ‰ä¸‹K4ï¼šç¡®è®¤å¹¶é€€å‡ºæ—¥å†ç•Œé¢ï¼Œç„¶åè¿”å›æ—¶é’Ÿç•Œé¢
1126   2              {
1127   3              delay1ms(20);//æ¶ˆæŠ–
1128   3              if(0==K4)//å†æ¬¡æ£€æµ‹æŒ‰é”®çŠ¶æ€
1129   3              {  
1130   4                while(0==K4);//é•¿æŒ‰åœç•™åœ¨æ­¤
1131   4                delay1ms(20);//æ¶ˆæŠ–
1132   4                cldSetLocation=0;
1133   4                whereNow=0;
1134   4              }
1135   3            } 
1136   2        }   
1137   1      }
1138          
1139          void stopwatch_display()
1140          {
1141   1          smg(1,table[stopwatch_time_fen/10]);
1142   1          smg(2,table[stopwatch_time_fen%10]);
1143   1          smg(3,table[10]);
1144   1          smg(4,table[stopwatch_time_miao/10]);
1145   1          smg(5,table_dot[stopwatch_time_miao%10]);
1146   1          smg(6,table[10]);
1147   1          smg(7,table[stopwatch_time_miao_2/10]);
1148   1          smg(8,table[stopwatch_time_miao_2%10]);
1149   1      }
1150          
1151          void stopwatch_set()
1152          {
1153   1        if(0==whereNow && 0==K5)//å¦‚æœæ­¤æ—¶åœ¨æ—¶é’Ÿç•Œé¢å¹¶æŒ‰ä¸‹äº†ç§’è¡¨æŒ‰é”®K5
1154   1        {
1155   2          delay1ms(20);//æ¶ˆæŠ–
1156   2          if(0==K5)//å†æ¬¡æ£€æµ‹æŒ‰é”®çŠ¶æ€
1157   2          { 
1158   3            while(0==K5);//é•¿æŒ‰ç­‰å¾…
1159   3            delay1ms(20);//æ¶ˆæŠ–
1160   3            whereNow=4;
1161   3          }
1162   2        }
1163   1        if(4==whereNow)
1164   1        {
1165   2          if(K1== 0)  // å¦‚æœæŒ‰ä¸‹K1
1166   2          { 
1167   3            delay1ms(20);  // æ¶ˆæŠ–
1168   3            if(K1 == 0) // å†æ¬¡æ£€æµ‹æŒ‰é”®çŠ¶æ€
C51 COMPILER V9.57.0.0   MAIN                                                              01/12/2026 15:52:53 PAGE 20  

1169   3            {  
1170   4              while(K1 == 0);  // ç­‰å¾…æŒ‰é”®é‡Šæ”¾
1171   4              delay1ms(20);  // æ¶ˆæŠ–
1172   4              if(stopwatch_state == 0 || stopwatch_state == 2)// å¦‚æœå½“å‰æ˜¯åœæ­¢æˆ–æš‚åœçŠ¶æ€
1173   4              {  
1174   5                stopwatch_state = 1;  // å¼€å§‹è¿è¡Œ
1175   5              } 
1176   4              else if(stopwatch_state == 1)// å¦‚æœå½“å‰æ˜¯è¿è¡ŒçŠ¶æ€
1177   4              {  
1178   5                stopwatch_state = 2;  // æš‚åœ
1179   5              }
1180   4            }
1181   3          }
1182   2          
1183   2          if(0 == K2)  // å¦‚æœæŒ‰ä¸‹K2
1184   2          { 
1185   3            delay1ms(20);  // æ¶ˆæŠ–
1186   3            if(0 == K2) // å†æ¬¡æ£€æµ‹æŒ‰é”®çŠ¶æ€
1187   3            {  
1188   4              while(0 == K2);  // ç­‰å¾…æŒ‰é”®é‡Šæ”¾
1189   4              delay1ms(20);  // æ¶ˆæŠ–
1190   4              stopwatch_time_miao_2 = 0;  // æ—¶é—´æ¸…é›¶
1191   4              stopwatch_time_miao = 0;
1192   4              stopwatch_time_fen = 0;
1193   4              stopwatch_state = 0;    // çŠ¶æ€ç½®ä¸ºåœæ­¢
1194   4              watch_count = 0;
1195   4            }
1196   3          }
1197   2          
1198   2          if(0==K4)//å¦‚æœæŒ‰ä¸‹K4ï¼šç¡®è®¤å¹¶é€€å‡ºç§’è¡¨ç•Œé¢ï¼Œç„¶åè¿”å›æ—¶é’Ÿç•Œé¢
1199   2          {
1200   3            delay1ms(20);//æ¶ˆæŠ–
1201   3            if(0==K4)//å†æ¬¡æ£€æµ‹æŒ‰é”®çŠ¶æ€
1202   3            {  
1203   4              while(0==K4);//é•¿æŒ‰åœç•™åœ¨æ­¤
1204   4              delay1ms(20);//æ¶ˆæŠ–
1205   4              whereNow=0;
1206   4            }
1207   3          } 
1208   2        }
1209   1      }
1210          
1211          void T_display()
1212          {
1213   1        uchar integer_part;    // æ•´æ•°éƒ¨åˆ†
1214   1        uchar decimal_part1;    // å°æ•°éƒ¨åˆ†1
1215   1        uchar decimal_part2;    // å°æ•°éƒ¨åˆ†2
1216   1        
1217   1        DS18B20_ConvertT();
1218   1        
1219   1        integer_part = (uchar)T;  // æ•´æ•°éƒ¨åˆ†
1220   1        decimal_part1 = (uchar)((T - integer_part) * 100);  // å°æ•°éƒ¨åˆ†1
1221   1        decimal_part2 = (uchar)((((T - integer_part)*100)-decimal_part1) * 100);  // å°æ•°éƒ¨åˆ†2
1222   1        
1223   1        smg(2,table[integer_part/10]);
1224   1        smg(3,table_dot[integer_part%10]);
1225   1        smg(4,table[decimal_part1/10]);
1226   1        smg(5,table[decimal_part1%10]);
1227   1        smg(6,table[decimal_part2/10]);
1228   1        smg(7,table[decimal_part2%10]);
1229   1        smg(8,0xA7);
1230   1      }
C51 COMPILER V9.57.0.0   MAIN                                                              01/12/2026 15:52:53 PAGE 21  

1231          
1232          void T_set()
1233          {
1234   1        if(0==whereNow && 0==K4)//å¦‚æœæ­¤æ—¶åœ¨æ—¶é’Ÿç•Œé¢å¹¶æŒ‰ä¸‹äº†ç§’è¡¨æŒ‰é”®K4
1235   1        {
1236   2          delay1ms(20);//æ¶ˆæŠ–
1237   2          if(0==K4)//å†æ¬¡æ£€æµ‹æŒ‰é”®çŠ¶æ€
1238   2          { 
1239   3            while(0==K4);//é•¿æŒ‰ç­‰å¾…
1240   3            delay1ms(20);//æ¶ˆæŠ–
1241   3            whereNow=5;
1242   3          }
1243   2        }
1244   1        
1245   1        if(5==whereNow && 0==K4)//å¦‚æœæ­¤æ—¶åœ¨æ—¶é’Ÿç•Œé¢å¹¶æŒ‰ä¸‹äº†ç§’è¡¨æŒ‰é”®K4
1246   1        {
1247   2          delay1ms(20);//æ¶ˆæŠ–
1248   2          if(0==K4)//å†æ¬¡æ£€æµ‹æŒ‰é”®çŠ¶æ€
1249   2          { 
1250   3            while(0==K4);//é•¿æŒ‰ç­‰å¾…
1251   3            delay1ms(20);//æ¶ˆæŠ–
1252   3            whereNow=0;
1253   3          }
1254   2        }
1255   1      }
1256          
1257          void main()
1258          {
1259   1        clockSetLocation=0; //
1260   1        alarmSetOrNot=0;  //
1261   1        alarmSetLocation=0; //
1262   1        cldSetOrNot=0;    //
1263   1        cldSetLocation=0;   //å„ç•Œé¢ä½ç½®æ ‡å¿—ä¸æ˜¯å¦è°ƒæ•´æ ‡å¿—åˆå§‹åŒ–ä¸º0
1264   1        alarmOnOff=0;   //é—¹é’Ÿé»˜è®¤å…³é—­
1265   1        whereNow=0;     //é»˜è®¤æœ€å¼€å§‹åœ¨æ—¶é’Ÿç•Œé¢
1266   1        blankCount=shanCount; //
1267   1        normalCount=shanCount;//é—ªçƒè®¡æ•°æ ‡å¿—åˆå§‹åŒ–
1268   1        Timer0_Init();  //å®šæ—¶å™¨T0åˆå§‹åŒ–
1269   1        
1270   1        while(1)
1271   1        {
1272   2          is_leap_year(); //åˆ¤æ–­æ˜¯å¦æ˜¯é—°å¹´ 
1273   2          if(0==whereNow || 1==whereNow)
1274   2            clock_display();//æ•°ç ç®¡åŠ¨æ€æ˜¾ç¤ºæ—¶é’Ÿç•Œé¢
1275   2          clock_set();  //è°ƒæ—¶(ä¸æ—¶é’ŸåŒç•Œé¢)  
1276   2          if(2==whereNow)
1277   2            alarm_display();  //æ•°ç ç®¡åŠ¨æ€æ˜¾ç¤ºé—¹é’Ÿç•Œé¢
1278   2          alarm_set();  //é—¹é’Ÿè®¾ç½®
1279   2          alarm_exe();  //é—¹é’Ÿæ‰§è¡Œ
1280   2          if(3==whereNow)
1281   2            cld_display();//æ•°ç ç®¡åŠ¨æ€æ˜¾ç¤ºæ—¥å†ç•Œé¢
1282   2          cld_set();    //æ—¥å†è®¾ç½®
1283   2          if(4==whereNow)
1284   2            stopwatch_display();
1285   2          stopwatch_set();
1286   2          if(5==whereNow)
1287   2            T_display();
1288   2          T_set();
1289   2        }
1290   1      }


C51 COMPILER V9.57.0.0   MAIN                                                              01/12/2026 15:52:53 PAGE 22  

MODULE INFORMATION:   STATIC OVERLAYABLE
   CODE SIZE        =   4317    ----
   CONSTANT SIZE    =   ----    ----
   XDATA SIZE       =   ----    ----
   PDATA SIZE       =   ----    ----
   DATA SIZE        =     79       2
   IDATA SIZE       =   ----    ----
   BIT SIZE         =      4    ----
END OF MODULE INFORMATION.


C51 COMPILATION COMPLETE.  0 WARNING(S),  0 ERROR(S)
